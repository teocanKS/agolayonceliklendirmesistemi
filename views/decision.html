<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KDS - Stratejik Senaryo ve Etki Analizi</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <style>
        .decision-grid {
            display: grid;
            grid-template-columns: 320px 1fr;
            gap: 24px;
        }

        .kpi-row {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
            margin-bottom: 24px;
        }

        .plan-card {
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid #374151;
            border-radius: 8px;
            padding: 24px;
            transition: all 0.3s ease;
            position: relative;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .plan-card:hover {
            transform: translateY(-2px);
            border-color: var(--brand);
            background: rgba(59, 130, 246, 0.05);
        }

        .active-plan {
            border-color: var(--brand);
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.2);
            background: rgba(59, 130, 246, 0.05);
        }

        .explanation-box {
            background: #1f2937;
            border-left: 4px solid var(--brand);
            padding: 16px;
            margin-bottom: 24px;
            font-size: 0.9rem;
            color: #d1d5db;
            border-radius: 0 4px 4px 0;
        }

        .metric-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 0.85rem;
            color: #9ca3af;
        }

        .metric-val {
            color: #fff;
            font-weight: 600;
        }
    </style>
</head>

<body>
    <div id="navbar-container"></div>
    <div class="app-container">
        <header class="page-header">
            <div>
                <h1>Stratejik Senaryo ve Etki Analizi</h1>
                <p class="subtitle">Parametrik Simülasyon ve Karar Destek Modeli (2025-2026 Planlama)</p>
            </div>
            <div class="last-updated">
                <button class="btn-primary" onclick="window.print()">Raporu Yazdır (PDF)</button>
            </div>
        </header>

        <div class="decision-grid">
            
            <aside>
                <div id="manager-panel-container"></div>

                <div class="chart-card" style="height: auto; padding: 16px; margin-bottom: 0;">
                    <h3 style="font-size:0.9rem; margin-bottom:8px;">Hesaplama Mantığı</h3>
                    <p style="font-size:0.8rem; color:#9ca3af; line-height: 1.5;">
                        Model, <strong>ağırlıklı puanlama yöntemi</strong> kullanır.
                        Varlık Kritikliği artınca "Stratejik Baskı" yükselir.
                        Müdahale Kapasitesi düşükse "Operasyonel Risk" artar.
                    </p>
                </div>
            </aside>

            
            <main>
                
                <div class="explanation-box" id="analysis-summary">
                    
                </div>

                
                <div class="kpi-row">
                    <div class="kpi-card" id="card-tactical">
                        <h3>Taktiksel Risk Endeksi</h3>
                        <div class="value" id="val-tactical">--</div>
                    </div>
                    <div class="kpi-card" id="card-strategic">
                        <h3>Stratejik Baskı Endeksi</h3>
                        <div class="value" id="val-strategic">--</div>
                    </div>
                    <div class="kpi-card">
                        <h3 id="lbl-budget">Yatırım Baskısı</h3>
                        <div class="value" id="val-budget" style="font-size:1.5rem">--</div>
                        <div id="desc-budget" style="font-size:0.7rem; color:#9ca3af; margin-top:4px;">Stratejik
                            risklere göre kaynak ihtiyacı.</div>
                    </div>
                </div>

                <div style="margin-bottom: 24px;">
                    <h3 style="margin-bottom:12px; color:#fff; font-size:1.1rem;">Önerilen Stratejik Planlar</h3>
                    <div style="display:grid; grid-template-columns: 1fr 1fr; gap:16px;" id="plans-container">
                        
                    </div>
                </div>

                
                <div class="chart-card" style="height: auto; padding: 24px;">
                    <h3 style="margin-bottom:16px;">Seçilen Strateji İçin Yol Haritası (6-12 Ay)</h3>
                    <div id="roadmap-content">
                        
                    </div>
                </div>
            </main>
        </div>
    </div>

    <script src="js/navbar.js"></script>
    <script src="js/params.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            ParamsManager.renderPanel('manager-panel-container');

            const Model = {
                // Core Logic
                calculate(params) {
                    // Base constants from "historical" analysis
                    const baseThreat = 50;

                    // 1. Tactical Risk (Day-to-day operations)
                    // Driven by Severity, Volume, Human Factor
                    // Mitigated by Response Capacity
                    let tactical = (baseThreat * params.severityWeight) +
                        (baseThreat * params.volumeWeight * 1.5) +
                        (baseThreat * params.humanFactor);

                    // Mitigation
                    tactical = tactical * (1.5 - params.responseCapacity);
                    tactical = Math.min(100, Math.max(10, Math.round(tactical)));

                    // 2. Strategic Pressure (Long-term, Governance)
                    // Driven by Asset Criticality, Human Factor
                    // Mitigated by Detection Maturity
                    let strategic = (baseThreat * params.assetCriticality * 2.0) +
                        (baseThreat * params.humanFactor * 0.5);

                    // Mitigation
                    strategic = strategic * (1.4 - params.detectionMaturity);
                    strategic = Math.min(100, Math.max(10, Math.round(strategic)));

                    return { tactical, strategic };
                },

                generatePlans(scores) {
                    const { tactical, strategic } = scores;
                    const plans = [];

                    // Plan 1: Default (Maintain)
                    plans.push({
                        id: 'default',
                        title: 'Plan 0: Mevcut Yapı ile İdame',
                        desc: 'Yatırım yapmadan, mevcut kapasite ve yamalarla operasyonu sürdür.',
                        impact: 'Risk seviyesi sabit kalır.',
                        cost: 'Düşük ($)',
                        time: '6 Ay (Gözden Geçirme)',
                        why: 'Düşük risk ortamında maliyet avantajı sağlar.',
                        score: (100 - tactical) + (100 - strategic)
                    });

                    // Plan 2: Capacity (Tactical Infrastructure)
                    plans.push({
                        id: 'capacity',
                        title: 'Plan A: Altyapı Genişletme ve Kapasite Planı',
                        desc: 'Yıllık %30 büyüme öngörüsüyle donanım ve bant genişliği artırımı.',
                        impact: 'Taktiksel Risk -%40',
                        cost: 'Yüksek ($$)',
                        time: '6-9 Ay',
                        why: 'Yüksek hacimli trafik ve operasyonel darboğaz riski (Taktiksel Endeks) baskın.',
                        score: tactical * 1.5
                    });

                    // Plan 3: Identity & Compliance (Strategic Security)
                    plans.push({
                        id: 'identity',
                        title: 'Plan B: Kimlik Yönetimi ve Zero Trust Geçişi',
                        desc: 'Kurumsal kimlik (IAM) modernizasyonu ve erişim politikalarının sıkılaştırılması.',
                        impact: 'Stratejik Baskı -%50',
                        cost: 'Orta ($$)',
                        time: '9-12 Ay',
                        why: 'Kritik varlık güvenliği ve yasal uyumluluk (İnsan Faktörü) riski yüksek.',
                        score: strategic * 1.5
                    });

                    // Plan 4: Hybrid (Full Transformation)
                    plans.push({
                        id: 'hybrid',
                        title: 'Plan C: Tam Kapsamlı Siber Dönüşüm',
                        desc: 'Plan A (Altyapı) ve Plan B (Kimlik) entegrasyonu + Yönetilen SOC hizmeti.',
                        impact: 'Toplam Risk -%70',
                        cost: 'Çok Yüksek ($$$)',
                        time: '12 Ay+',
                        why: 'Hem operasyonel hem stratejik riskler kabul edilemez seviyede.',
                        score: (tactical > 70 && strategic > 70) ? 500 : 0
                    });

                    return plans.sort((a, b) => b.score - a.score);
                },

                getRoadmap(planId) {
                    const roadmaps = {
                        'default': [
                            'Ay 1-2: Mevcut envanterin doğrulanması ve risk kabulü imzaları.',
                            'Ay 3-4: Kritik yamaların uygulanması ve acil durum tatbikatı.',
                            'Ay 5-6: 6 aylık performans raporu ve bütçe revizyonu.'
                        ],
                        'capacity': [
                            'Ay 1-3: Trafik analizi, darboğaz tespiti ve donanım ihale süreci.',
                            'Ay 4-6: Yeni Firewall/IPS donanımlarının devreye alınması ve yük testleri.',
                            'Ay 7-9: CDN ve Cloud WAF entegrasyonu ile küresel trafik optimizasyonu.'
                        ],
                        'identity': [
                            'Ay 1-3: Mevcut yetki matrisinin analizi ve gereksiz yetkilerin temizlenmesi.',
                            'Ay 4-6: MFA (Çok Faktörlü Kimlik Doğrulama) zorunluluğunun tüm birimlere yayılması.',
                            'Ay 7-12: Zero Trust ağ segmentasyonu ve PAM (Ayrıcalıklı Erişim) projesi.'
                        ],
                        'hybrid': [
                            'Ay 1-3: Acil kapasite artırımı ve SOC hizmet alımı (Quick Wins).',
                            'Ay 4-8: Kimlik yönetimi (IAM) ve Ağ güvenliği dönüşümünün paralel yürütülmesi.',
                            'Ay 9-12: ISO 27001 ve KVKK tam uyumluluk denetimi ve sertifikasyon.'
                        ]
                    };
                    return roadmaps[planId] || roadmaps['default'];
                }
            };

            function updateUI() {
                const params = ParamsManager.getParams();
                const scores = Model.calculate(params);
                const plans = Model.generatePlans(scores);
                const bestPlan = plans[0];

                // Update KPIs
                document.getElementById('val-tactical').innerText = scores.tactical;
                document.getElementById('val-strategic').innerText = scores.strategic;

                // Color coding
                const tHeader = document.getElementById('card-tactical');
                const sHeader = document.getElementById('card-strategic');
                tHeader.className = `kpi-card ${scores.tactical > 70 ? 'critical' : (scores.tactical > 40 ? 'high' : '')}`;
                sHeader.className = `kpi-card ${scores.strategic > 70 ? 'critical' : (scores.strategic > 40 ? 'high' : '')}`;

                // Analysis Explanation
                const analysisBox = document.getElementById('analysis-summary');
                let analysisText = `<strong>Analiz Sonucu:</strong> Şu anki parametrelere göre, `;
                if (scores.tactical > scores.strategic) {
                    analysisText += `operasyonel tehditler (Taktiksel) daha baskın görünüyor. Ağ bant genişliği ve erişilebilirlik risk altında.`;
                } else {
                    analysisText += `stratejik ve uyumluluk riskleri (Varlık/İnsan) daha ön planda. Veri gizliliği ve kurumsal itibar risk altında.`;
                }
                analysisBox.innerHTML = analysisText;

                // Investment Pressure (Relative)
                const pressureScore = (scores.strategic * 0.6) + (scores.tactical * 0.4);
                let pressureLabel = 'Düşük';
                let pressureColor = 'var(--success)';

                if (pressureScore > 40) { pressureLabel = 'Orta'; pressureColor = 'var(--warning)'; }
                if (pressureScore > 75) { pressureLabel = 'Yüksek'; pressureColor = 'var(--danger)'; }

                document.getElementById('val-budget').innerHTML = `<span style="color:${pressureColor}">${pressureLabel}</span>`;
                document.getElementById('lbl-budget').innerText = "Yatırım Baskısı";
                document.getElementById('desc-budget').innerText = "Mevcut risk seviyesine göre bütçe kullanım aciliyeti.";

                // Render Plans
                const container = document.getElementById('plans-container');
                container.innerHTML = plans.map((p, index) => `
                    <div class="plan-card ${index === 0 ? 'active-plan' : ''}">
                        <div style="display:flex; justify-content:space-between; align-items:flex-start; margin-bottom:12px;">
                            <h4 style="margin:0; font-size:1rem; color:#fff;">${p.title}</h4>
                            ${index === 0 ? '<span style="background:#10b981; color:#fff; font-size:0.7rem; padding:2px 6px; border-radius:4px;">ÖNERİLEN</span>' : ''}
                        </div>
                        <p style="font-size:0.85rem; color:#d1d5db; margin-bottom:16px; flex-grow:1;">${p.desc}</p>
                        
                        <div style="border-top:1px solid rgba(255,255,255,0.1); padding-top:12px;">
                            <div class="metric-row"><span>Etki:</span> <span class="metric-val" style="color:#60a5fa">${p.impact}</span></div>
                            <div class="metric-row"><span>Maliyet:</span> <span class="metric-val">${p.cost}</span></div>
                            <div class="metric-row"><span>Süre:</span> <span class="metric-val">${p.time}</span></div>
                        </div>
                        
                        <div style="margin-top:12px; font-size:0.8rem; color:#9ca3af; font-style:italic;">
                            <strong>Neden:</strong> ${p.why}
                        </div>
                    </div>
                `).join('');

                // Render Roadmap
                const roadmap = Model.getRoadmap(bestPlan.id);
                document.getElementById('roadmap-content').innerHTML = `
                    <ul style="list-style:none; padding:0; color:#d1d5db; font-size:0.95rem;">
                        ${roadmap.map(item => `<li style="margin-bottom:8px; padding-left:16px; border-left:2px solid var(--brand);">${item}</li>`).join('')}
                    </ul>
                `;
            }

            window.addEventListener('kds-params-changed', updateUI);
            updateUI(); // Initial
        });
    </script>
</body>

</html>